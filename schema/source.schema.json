{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/WICG/attribution-reporting-api/source.schema.json",
  "title": "Source",
  "description": "An Attribution Reporting source registration",
  "type": "object",
  "properties": {
    "aggregatable_report_window": {
      "$ref": "#/$defs/unsigned_base10_integer"
    },
    "aggregation_keys": {
      "type": "object",
      "additionalProperties": {
        "type": "string",
        "pattern": "^0[xX][0-9a-fA-F]{1,32}$"
      },
      "maxProperties": 20
    },
    "debug_key": {
      "$ref": "#/$defs/unsigned_base10_integer"
    },
    "debug_reporting": {
      "type": "boolean"
    },
    "destination": {
      "type": ["array", "string"],
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "maxItems": 3
    },
    "event_report_window": {
      "$ref": "#/$defs/unsigned_base10_integer"
    },
    "expiry": {
      "$ref": "#/$defs/unsigned_base10_integer"
    },
    "filter_data": {
      "type": "object",
      "propertyNames": {
        "not": {
          "pattern": "^source_type$"
        }
      },
      "additionalProperties": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "maxItems": 50
      },
      "maxProperties": 50
    },
    "priority": {
      "$ref": "#/$defs/signed_base10_integer"
    },
    "source_event_id": {
      "$ref": "#/$defs/unsigned_base10_integer"
    }
  },
  "required": ["destination"],

  "$defs": {
    "signed_base10_integer": {
      "type": "string",
      "pattern": "^-?[0-9]+$"
    },
    "unsigned_base10_integer": {
      "type": "string",
      "pattern": "^[0-9]+$"
    }
  }
}
